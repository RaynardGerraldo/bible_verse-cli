#!/bin/bash

if [ "$1" == "-h" ]; then
  echo "Usage: ./bible_verse book_name chapter verse [version]"
  echo "Example: 
  	./bible_verse John 3 16 KJV (ESV by default)
  	./bible_verse John 3 16-21 KJV"
  echo "For output to image
  	./bible_verse John 3 16 KJV | python3 verseonimage.py
  	./bible_verse John 3 16-21 KJV | python3 verseonimage.py"
  exit 0
fi

if [ $# -ne 3 ] && [ $# -ne 4 ]; then
  echo "Error: Incorrect number of arguments."
  exit 1
fi

# Extract chapter and verse from command line arguments
book_name=$1
chapter=$2
verse=$3
version="ESV"

# Use as version if version argument exist
if [ $# -eq 4 ]; then
  version=$4
fi

# Read the specified verse from the Bible
bible=$(curl -s "https://www.biblegateway.com/passage/?search=$book_name+$chapter:$verse&version=$version")
# Extract the verse text from the HTML response
verse_text=$(echo "$bible" | sed -n 's/.*<meta property="og:description" content="\(.*\)".*/\1/p')

echo "$book_name $chapter $verse $version"
echo "$verse_text"

